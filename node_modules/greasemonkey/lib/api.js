"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var _GMApi;
(function (_GMApi_1) {
    let _hasGM = typeof GM !== 'undefined';
    let _a = [
        'GM_info',
        'GM_deleteValue',
        'GM_getValue',
        'GM_setValue',
        'GM_listValues',
        'GM_openInTab',
        'GM_setClipboard',
        'GM_xmlhttpRequest',
        'GM_getResourceText',
        'GM_log',
        'GM_addStyle',
        'GM_registerMenuCommand',
    ];
    for (let name of _a) {
        let fn = eval(`(typeof ${name} !== 'undefined') ? ${name} : void(0)`);
        _GMApi[name.replace(/^GM_/, '')] = fn;
    }
    _GMApi.getResourceUrl = (typeof GM_getResourceUrl !== 'undefined' ? GM_getResourceUrl : (typeof GM_getResourceURL !== 'undefined' ? GM_getResourceURL : void (0)));
    if (_hasGM) {
        Object.keys(GM)
            .concat([
            'info',
            'deleteValue',
            'getValue',
            'listValues',
            'setValue',
            'getResourceUrl',
            'openInTab',
            'setClipboard',
            'xmlHttpRequest',
            'getResourceText',
            'log',
            'addStyle',
            'registerMenuCommand',
        ])
            .forEach(function (value, index, array) {
            if (typeof _GMApi[value] === 'undefined') {
                _GMApi[value] = typeof GM[value] !== 'undefined' ? GM[value] : void (0);
            }
        });
    }
    if (!_hasGM) {
        try {
            let _a = [
                'GM_notification',
                'GM_getTab',
                'GM_saveTab',
                'GM_getTabs',
                'GM_download',
                'GM_unregisterMenuCommand',
                'GM_addValueChangeListener',
                'GM_removeValueChangeListener',
            ];
            for (let name of _a) {
                let value = name.replace(/^GM_/, '');
                if (typeof _GMApi[value] === 'undefined') {
                    let fn = eval(`(typeof ${name} !== 'undefined') ? ${name} : void(0)`);
                    _GMApi[value] = fn;
                }
            }
        }
        catch (e) {
            console.error(e);
        }
    }
    let _isTampermonkey = null;
    if (_GMApi.info) {
        if (!_GMApi.info.scriptHandler) {
            _isTampermonkey = false;
        }
        else if (_GMApi.info.scriptHandler == 'Tampermonkey') {
            _isTampermonkey = true;
        }
        else if (_GMApi.info.scriptHandler == 'Greasemonkey') {
            _isTampermonkey = false;
        }
    }
    else if (_hasGM) {
        _isTampermonkey = false;
    }
    let _t_list = [];
    let _t_keys = Object.keys(_GMApi);
    _GMApi.GM = _hasGM ? GM : {};
    _t_keys
        .forEach(function (value, index, array) {
        if (typeof _GMApi.GM[value] == 'undefined') {
            _GMApi.GM[value] = _GMApi[value];
        }
        _GMApi['GM_' + value] = _GMApi[value];
        _t_list.push(value);
        _t_list.push('GM_' + value);
    });
    _GMApi_1._list = _t_list;
    _GMApi_1.isTampermonkey = _isTampermonkey;
    _GMApi_1.hasGM = _hasGM;
    _GMApi.unsafeWindow = typeof unsafeWindow !== 'undefined' ? unsafeWindow : (typeof window !== 'undefined'
        ? window
        : void (0));
    function call(method, ...argv) {
        if (typeof _GMApi[method] == 'function') {
            return _GMApi[method].call(_GMApi['GM'] || null, ...argv);
        }
        else if (typeof _GMApi[method] == 'undefined') {
            console.warn(`GMApi.${method} is undefined`);
        }
        return _GMApi[method];
    }
    _GMApi_1.call = call;
    function callSafe(method) {
        if (typeof _GMApi[method] == 'function') {
            return _GMApi[method];
        }
        return new Function();
    }
    _GMApi_1.callSafe = callSafe;
})(_GMApi || (_GMApi = {}));
_GMApi._list.forEach(function (value, index, array) {
    if (value.indexOf('GM_') == 0) {
        module.exports[value] = _GMApi[value];
    }
});
_GMApi.default = _GMApi.GMApi = _GMApi;
exports.GMApi = _GMApi;
exports.default = exports.GMApi;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBNkxBLElBQVUsTUFBTSxDQXlNZjtBQXpNRCxXQUFVLFFBQU07SUFJZixJQUFJLE1BQU0sR0FBRyxPQUFPLEVBQUUsS0FBSyxXQUFXLENBQUM7SUFFdkMsSUFBSSxFQUFFLEdBQUc7UUFDUixTQUFTO1FBRVQsZ0JBQWdCO1FBQ2hCLGFBQWE7UUFDYixhQUFhO1FBQ2IsZUFBZTtRQUVmLGNBQWM7UUFFZCxpQkFBaUI7UUFFakIsbUJBQW1CO1FBQ25CLG9CQUFvQjtRQUVwQixRQUFRO1FBRVIsYUFBYTtRQUNiLHdCQUF3QjtLQUN4QixDQUFDO0lBRUYsS0FBSyxJQUFJLElBQUksSUFBSSxFQUFFLEVBQ25CO1FBQ0MsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDLFdBQVcsSUFBSSx1QkFBdUIsSUFBSSxZQUFZLENBQUMsQ0FBQztRQUV0RSxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUM7S0FHdEM7SUFPRCxNQUFNLENBQUMsY0FBYyxHQUFHLENBRXZCLE9BQU8saUJBQWlCLEtBQUssV0FBVyxDQUFDLENBQUMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUMsQ0FDOUQsT0FBTyxpQkFBaUIsS0FBSyxXQUFXLENBQUMsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxLQUFJLENBQUMsQ0FBQyxDQUFDLENBQ3RFLENBQUMsQ0FDRjtJQVdELElBQUksTUFBTSxFQUNWO1FBQ0MsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7YUFDYixNQUFNLENBQUM7WUFDUCxNQUFNO1lBQ04sYUFBYTtZQUNiLFVBQVU7WUFDVixZQUFZO1lBQ1osVUFBVTtZQUNWLGdCQUFnQjtZQUNoQixXQUFXO1lBQ1gsY0FBYztZQUNkLGdCQUFnQjtZQUVoQixpQkFBaUI7WUFDakIs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LEtBQUssQ0FBQyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUN0QztBQUNGLENBQUMsQ0FBQyxDQUFDO0FBRUYsTUFBZSxDQUFDLE9BQU8sR0FBSSxNQUFlLENBQUMsS0FBSyxHQUFHLE1BQWMsQ0FBQztBQUV0RCxRQUFBLEtBQUssR0FBUyxNQUFjLENBQUM7QUFFMUMsa0JBQWdCLGFBQWMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSB1c2VyIG9uIDIwMTcvMTEvMjYvMDI2LlxuICovXG5cbi8qKlxuICogQHNlZSBodHRwczovL3dpa2kuZ3JlYXNlc3BvdC5uZXQvR3JlYXNlbW9ua2V5X01hbnVhbDpBUElcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJR01cbntcblx0aW5mbzogSUluZm8sXG5cblx0ZGVsZXRlVmFsdWUobmFtZTogc3RyaW5nKTtcblxuXHRnZXRWYWx1ZTxULCBVPihuYW1lOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZT86IFUpOiBVO1xuXG5cdGxpc3RWYWx1ZXMoKTogc3RyaW5nW107XG5cblx0c2V0VmFsdWU8VCwgVT4obmFtZTogc3RyaW5nLCB2YWx1ZTogVSk7XG5cblx0Z2V0UmVzb3VyY2VVcmwocmVzb3VyY2VOYW1lOiBzdHJpbmcpOiBzdHJpbmc7XG5cblx0b3BlbkluVGFiKHVybDogc3RyaW5nLCBvcGVuX2luX2JhY2tncm91bmQ/OiBib29sZWFuKTogV2luZG93O1xuXG5cdHNldENsaXBib2FyZCh0ZXh0OiBzdHJpbmcpO1xuXG5cdHhtbGh0dHBSZXF1ZXN0KG9wdGlvbnM6IEdNWE1MSHR0cFJlcXVlc3RPcHRpb25zKTogR01YTUxIdHRwUmVxdWVzdFJlc3VsdDtcblxuXHRnZXRSZXNvdXJjZVRleHQocmVzb3VyY2VOYW1lOiBzdHJpbmcpOiBzdHJpbmc7XG5cblx0bG9nKG1lc3NhZ2U6IGFueSk7XG5cblx0YWRkU3R5bGUoY3NzOiBzdHJpbmcpO1xuXG5cdHJlZ2lzdGVyTWVudUNvbW1hbmQoY2FwdGlvbjogc3RyaW5nLCBjb21tYW5kRnVuYzogRnVuY3Rpb24sIGFjY2Vzc0tleT86IHN0cmluZyk7XG59XG5cbmRlY2xhcmUgY29uc3QgR006IElHTTtcblxuZXhwb3J0IGludGVyZmFjZSBJQXBpIGV4dGVuZHMgSUdNXG57XG5cdEdNPzogSUdNO1xuXG5cdEdNX2luZm86IElJbmZvLFxuXG5cdEdNX2RlbGV0ZVZhbHVlKG5hbWU6IHN0cmluZyk7XG5cblx0R01fZ2V0VmFsdWU8VCwgVT4obmFtZTogc3RyaW5nLCBkZWZhdWx0VmFsdWU/OiBVKTogVTtcblxuXHRHTV9saXN0VmFsdWVzKCk6IHN0cmluZ1tdO1xuXG5cdEdNX3NldFZhbHVlPFQsIFU+KG5hbWU6IHN0cmluZywgdmFsdWU6IFUpO1xuXG5cdEdNX2dldFJlc291cmNlVXJsKHJlc291cmNlTmFtZTogc3RyaW5nKTogc3RyaW5nO1xuXG5cdEdNX29wZW5JblRhYih1cmw6IHN0cmluZywgb3Blbl9pbl9iYWNrZ3JvdW5kPzogYm9vbGVhbik6IFdpbmRvdztcblxuXHRHTV9zZXRDbGlwYm9hcmQodGV4dDogc3RyaW5nKTtcblxuXHRHTV94bWxodHRwUmVxdWVzdChvcHRpb25zOiBHTVhNTEh0dHBSZXF1ZXN0T3B0aW9ucyk6IEdNWE1MSHR0cFJlcXVlc3RSZXN1bHQ7XG5cblx0R01fZ2V0UmVzb3VyY2VUZXh0KHJlc291cmNlTmFtZTogc3RyaW5nKTogc3RyaW5nO1xuXG5cdEdNX2xvZzxUPihtZXNzYWdlOiBUKTtcblxuXHRHTV9hZGRTdHlsZShjc3M6IHN0cmluZyk7XG5cblx0R01fcmVnaXN0ZXJNZW51Q29tbWFuZChjYXB0aW9uOiBzdHJpbmcsIGNvbW1hbmRGdW5jOiBGdW5jdGlvbiwgYWNjZXNzS2V5Pzogc3RyaW5nKTtcblxuXHR1bnNhZmVXaW5kb3c6IFdpbmRvdztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJVGFtcGVybW9ua2V5R01cbntcblx0aW5mbzogSVRhbXBlcm1vbmtleUluZm87XG5cblx0bm90aWZpY2F0aW9uPyxcblxuXHRnZXRUYWI/LFxuXHRzYXZlVGFiPyxcblx0Z2V0VGFicz8sXG5cblx0ZG93bmxvYWQ/LFxuXG5cdHVucmVnaXN0ZXJNZW51Q29tbWFuZD8sXG5cblx0YWRkVmFsdWVDaGFuZ2VMaXN0ZW5lcj8sXG5cdHJlbW92ZVZhbHVlQ2hhbmdlTGlzdGVuZXI/LFxufVxuXG4vKipcbiAqIEBzZWUgaHR0cDovL3RhbXBlcm1vbmtleS5uZXQvZG9jdW1lbnRhdGlvbi5waHBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJVGFtcGVybW9ua2V5XG57XG5cdEdNX2luZm86IElUYW1wZXJtb25rZXlJbmZvO1xuXG5cdEdNX29wZW5JblRhYih1cmw6IHN0cmluZywgbG9hZEluQmFja2dyb3VuZD86IGJvb2xlYW4pO1xuXG5cdEdNX29wZW5JblRhYih1cmw6IHN0cmluZywgb3B0aW9ucz86IGFueSk7XG5cblx0R01fbm90aWZpY2F0aW9uKHRleHQ6IHN0cmluZywgdGl0bGU/OiBzdHJpbmcsIGltYWdlPzogc3RyaW5nLCBvbmNsaWNrPyk7XG5cblx0R01fbm90aWZpY2F0aW9uKGRldGFpbHM6IHtcblx0XHR0ZXh0Pzogc3RyaW5nLFxuXHRcdHRpdGxlPzogc3RyaW5nLFxuXHRcdGltYWdlPzogc3RyaW5nLFxuXHRcdGhpZ2hsaWdodD86IGJvb2xlYW4sXG5cdFx0dGltZW91dD86IG51bWJlcixcblx0XHRvbmRvbmU/LFxuXHRcdG9uY2xpY2s/LFxuXHR9LCBvbmRvbmU/KTtcblxuXHRHTV9nZXRUYWIoY2IpO1xuXG5cdEdNX3NhdmVUYWIodGFiKTtcblxuXHRHTV9nZXRUYWJzKGNiKTtcblxuXHRHTV9kb3dubG9hZCh1cmw6IHN0cmluZywgbmFtZT86IHN0cmluZyk7XG5cblx0R01fZG93bmxvYWQoZGV0YWlsczoge1xuXHRcdHVybDogc3RyaW5nLFxuXHRcdG5hbWU/OiBzdHJpbmcsXG5cdFx0aGVhZGVycz8sXG5cdFx0c2F2ZUFzPzogYm9vbGVhbixcblx0XHRvbmxvYWQ/LFxuXHRcdG9uZXJyb3I/LFxuXHR9KTtcblxuXHRHTV91bnJlZ2lzdGVyTWVudUNvbW1hbmQobWVudUNtZElkKTtcblxuXHRHTV9hZGRWYWx1ZUNoYW5nZUxpc3RlbmVyKG5hbWUsIGNiOiBJR01fYWRkVmFsdWVDaGFuZ2VMaXN0ZW5lckZuKTtcblxuXHRHTV9yZW1vdmVWYWx1ZUNoYW5nZUxpc3RlbmVyKGxpc3RlbmVyX2lkKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJR01fYWRkVmFsdWVDaGFuZ2VMaXN0ZW5lckZuIGV4dGVuZHMgRnVuY3Rpb25cbntcblx0KG5hbWU6IHN0cmluZywgb2xkX3ZhbHVlLCBuZXdfdmFsdWUsIHJlbW90ZTogYm9vbGVhbik7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRhbXBlcm1vbmtleUluZm8gZXh0ZW5kcyBJSW5mb1xue1xuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUFwaSBleHRlbmRzIElUYW1wZXJtb25rZXksIElUYW1wZXJtb25rZXlHTVxue1xuXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUFwaVxue1xuXHRHTUFwaTogSUFwaTtcblx0ZGVmYXVsdDogSUFwaTtcblxuXHRpc1RhbXBlcm1vbmtleTogYm9vbGVhbjtcblx0aGFzR006IGJvb2xlYW47XG5cblx0X2xpc3Q6IHN0cmluZ1tdO1xuXG5cdGNhbGwobWV0aG9kOiBzdHJpbmcsIC4uLmFyZ3YpO1xuXG5cdGNhbGxTYWZlKG1ldGhvZDogc3RyaW5nKTogRnVuY3Rpb247XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUluZm9cbntcblx0c2NyaXB0Pzoge1xuXHRcdGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuXHRcdGV4Y2x1ZGVzPzogc3RyaW5nW107XG5cdFx0aW5jbHVkZXM/OiBzdHJpbmdbXTtcblx0XHRtYXRjaGVzPzogc3RyaW5nW107XG5cdFx0bmFtZT86IHN0cmluZztcblx0XHRuYW1lc3BhY2U/OiBzdHJpbmc7XG5cdFx0cmVzb3VyY2VzPzogT2JqZWN0O1xuXHRcdFwicnVuLWF0XCI/OiBzdHJpbmc7XG5cdFx0dW53cmFwPzogYm9vbGVhbjtcblx0XHR2ZXJzaW9uPzogc3RyaW5nO1xuXHR9O1xuXHRzY3JpcHRNZXRhU3RyPzogc3RyaW5nO1xuXHRzY3JpcHRXaWxsVXBkYXRlPzogYm9vbGVhbjtcblx0dmVyc2lvbj86IHN0cmluZztcblxuXHRbaW5kZXg6IHN0cmluZ106IGFueTtcblxuXHRzY3JpcHRIYW5kbGVyPzogc3RyaW5nO1xufVxuXG5uYW1lc3BhY2UgX0dNQXBpXG57XG5cdGRlY2xhcmUgY29uc3QgX0dNQXBpOiBJQXBpO1xuXG5cdGxldCBfaGFzR00gPSB0eXBlb2YgR00gIT09ICd1bmRlZmluZWQnO1xuXG5cdGxldCBfYSA9IFtcblx0XHQnR01faW5mbycsXG5cblx0XHQnR01fZGVsZXRlVmFsdWUnLFxuXHRcdCdHTV9nZXRWYWx1ZScsXG5cdFx0J0dNX3NldFZhbHVlJyxcblx0XHQnR01fbGlzdFZhbHVlcycsXG5cblx0XHQnR01fb3BlbkluVGFiJyxcblxuXHRcdCdHTV9zZXRDbGlwYm9hcmQnLFxuXG5cdFx0J0dNX3htbGh0dHBSZXF1ZXN0Jyxcblx0XHQnR01fZ2V0UmVzb3VyY2VUZXh0JyxcblxuXHRcdCdHTV9sb2cnLFxuXG5cdFx0J0dNX2FkZFN0eWxlJyxcblx0XHQnR01fcmVnaXN0ZXJNZW51Q29tbWFuZCcsXG5cdF07XG5cblx0Zm9yIChsZXQgbmFtZSBvZiBfYSlcblx0e1xuXHRcdGxldCBmbiA9IGV2YWwoYCh0eXBlb2YgJHtuYW1lfSAhPT0gJ3VuZGVmaW5lZCcpID8gJHtuYW1lfSA6IHZvaWQoMClgKTtcblxuXHRcdF9HTUFwaVtuYW1lLnJlcGxhY2UoL15HTV8vLCAnJyldID0gZm47XG5cblx0XHQvL2NvbnNvbGUubG9nKG5hbWUsIGZuKTtcblx0fVxuXG5cdC8vX0dNQXBpLmluZm8gPSB0eXBlb2YgR01faW5mbyAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9pbmZvIDogdm9pZCgwKTtcblx0Ly9fR01BcGkuZGVsZXRlVmFsdWUgPSB0eXBlb2YgR01fZGVsZXRlVmFsdWUgIT09ICd1bmRlZmluZWQnID8gR01fZGVsZXRlVmFsdWUgOiB2b2lkKDApO1xuXHQvL19HTUFwaS5nZXRWYWx1ZSA9IHR5cGVvZiBHTV9nZXRWYWx1ZSAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9nZXRWYWx1ZSA6IHZvaWQoMCk7XG5cdC8vX0dNQXBpLmxpc3RWYWx1ZXMgPSB0eXBlb2YgR01fbGlzdFZhbHVlcyAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9saXN0VmFsdWVzIDogdm9pZCgwKTtcblx0Ly9fR01BcGkuc2V0VmFsdWUgPSB0eXBlb2YgR01fc2V0VmFsdWUgIT09ICd1bmRlZmluZWQnID8gR01fc2V0VmFsdWUgOiB2b2lkKDApO1xuXHRfR01BcGkuZ2V0UmVzb3VyY2VVcmwgPSAoXG5cdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdHR5cGVvZiBHTV9nZXRSZXNvdXJjZVVybCAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9nZXRSZXNvdXJjZVVybCA6IChcblx0XHRcdHR5cGVvZiBHTV9nZXRSZXNvdXJjZVVSTCAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9nZXRSZXNvdXJjZVVSTCA6IHZvaWQoMClcblx0XHQpKVxuXHQ7XG5cdC8vX0dNQXBpLm9wZW5JblRhYiA9IHR5cGVvZiBHTV9vcGVuSW5UYWIgIT09ICd1bmRlZmluZWQnID8gR01fb3BlbkluVGFiIDogdm9pZCgwKTtcblx0Ly9fR01BcGkuc2V0Q2xpcGJvYXJkID0gdHlwZW9mIEdNX3NldENsaXBib2FyZCAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9zZXRDbGlwYm9hcmQgOiB2b2lkKDApO1xuXHQvL19HTUFwaS54bWxodHRwUmVxdWVzdCA9IHR5cGVvZiBHTV94bWxodHRwUmVxdWVzdCAhPT0gJ3VuZGVmaW5lZCcgPyBHTV94bWxodHRwUmVxdWVzdCA6IHZvaWQoMCk7XG5cblx0Ly9fR01BcGkuZ2V0UmVzb3VyY2VUZXh0ID0gdHlwZW9mIEdNX2dldFJlc291cmNlVGV4dCAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9nZXRSZXNvdXJjZVRleHQgOiB2b2lkKDApO1xuXHQvL19HTUFwaS5sb2cgPSB0eXBlb2YgR01fbG9nICE9PSAndW5kZWZpbmVkJyA/IEdNX2xvZyA6IHZvaWQoMCk7XG5cdC8vX0dNQXBpLmFkZFN0eWxlID0gdHlwZW9mIEdNX2FkZFN0eWxlICE9PSAndW5kZWZpbmVkJyA/IEdNX2FkZFN0eWxlIDogdm9pZCgwKTtcblxuXHQvL19HTUFwaS5yZWdpc3Rlck1lbnVDb21tYW5kID0gdHlwZW9mIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQgIT09ICd1bmRlZmluZWQnID8gR01fcmVnaXN0ZXJNZW51Q29tbWFuZCA6IHZvaWQoMCk7XG5cblx0aWYgKF9oYXNHTSlcblx0e1xuXHRcdE9iamVjdC5rZXlzKEdNKVxuXHRcdFx0LmNvbmNhdChbXG5cdFx0XHRcdCdpbmZvJyxcblx0XHRcdFx0J2RlbGV0ZVZhbHVlJyxcblx0XHRcdFx0J2dldFZhbHVlJyxcblx0XHRcdFx0J2xpc3RWYWx1ZXMnLFxuXHRcdFx0XHQnc2V0VmFsdWUnLFxuXHRcdFx0XHQnZ2V0UmVzb3VyY2VVcmwnLFxuXHRcdFx0XHQnb3BlbkluVGFiJyxcblx0XHRcdFx0J3NldENsaXBib2FyZCcsXG5cdFx0XHRcdCd4bWxIdHRwUmVxdWVzdCcsXG5cblx0XHRcdFx0J2dldFJlc291cmNlVGV4dCcsXG5cdFx0XHRcdCdsb2cnLFxuXHRcdFx0XHQnYWRkU3R5bGUnLFxuXG5cdFx0XHRcdCdyZWdpc3Rlck1lbnVDb21tYW5kJyxcblx0XHRcdF0pXG5cdFx0XHQuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGluZGV4LCBhcnJheSlcblx0XHRcdHtcblx0XHRcdFx0aWYgKHR5cGVvZiBfR01BcGlbdmFsdWVdID09PSAndW5kZWZpbmVkJylcblx0XHRcdFx0e1xuXHRcdFx0XHRcdF9HTUFwaVt2YWx1ZV0gPSB0eXBlb2YgR01bdmFsdWVdICE9PSAndW5kZWZpbmVkJyA/IEdNW3ZhbHVlXSA6IHZvaWQoMCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0O1xuXHR9XG5cblx0aWYgKCFfaGFzR00pXG5cdHtcblx0XHR0cnlcblx0XHR7XG5cdFx0XHRsZXQgX2EgPSBbXG5cdFx0XHRcdCdHTV9ub3RpZmljYXRpb24nLFxuXG5cdFx0XHRcdCdHTV9nZXRUYWInLFxuXHRcdFx0XHQnR01fc2F2ZVRhYicsXG5cdFx0XHRcdCdHTV9nZXRUYWJzJyxcblxuXHRcdFx0XHQnR01fZG93bmxvYWQnLFxuXG5cdFx0XHRcdCdHTV91bnJlZ2lzdGVyTWVudUNvbW1hbmQnLFxuXG5cdFx0XHRcdCdHTV9hZGRWYWx1ZUNoYW5nZUxpc3RlbmVyJyxcblx0XHRcdFx0J0dNX3JlbW92ZVZhbHVlQ2hhbmdlTGlzdGVuZXInLFxuXHRcdFx0XTtcblxuXHRcdFx0Zm9yIChsZXQgbmFtZSBvZiBfYSlcblx0XHRcdHtcblx0XHRcdFx0bGV0IHZhbHVlID0gbmFtZS5yZXBsYWNlKC9eR01fLywgJycpO1xuXG5cdFx0XHRcdGlmICh0eXBlb2YgX0dNQXBpW3ZhbHVlXSA9PT0gJ3VuZGVmaW5lZCcpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRsZXQgZm4gPSBldmFsKGAodHlwZW9mICR7bmFtZX0gIT09ICd1bmRlZmluZWQnKSA/ICR7bmFtZX0gOiB2b2lkKDApYCk7XG5cblx0XHRcdFx0XHRfR01BcGlbdmFsdWVdID0gZm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvL2NvbnNvbGUubG9nKG5hbWUsIGZuKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Y2F0Y2ggKGUpXG5cdFx0e1xuXHRcdFx0Y29uc29sZS5lcnJvcihlKTtcblx0XHR9XG5cdH1cblxuXHRsZXQgX2lzVGFtcGVybW9ua2V5ID0gbnVsbDtcblxuXHRpZiAoX0dNQXBpLmluZm8pXG5cdHtcblx0XHRpZiAoIV9HTUFwaS5pbmZvLnNjcmlwdEhhbmRsZXIpXG5cdFx0e1xuXHRcdFx0X2lzVGFtcGVybW9ua2V5ID0gZmFsc2U7XG5cdFx0fVxuXHRcdGVsc2UgaWYgKF9HTUFwaS5pbmZvLnNjcmlwdEhhbmRsZXIgPT0gJ1RhbXBlcm1vbmtleScpXG5cdFx0e1xuXHRcdFx0X2lzVGFtcGVybW9ua2V5ID0gdHJ1ZTtcblx0XHR9XG5cdFx0ZWxzZSBpZiAoX0dNQXBpLmluZm8uc2NyaXB0SGFuZGxlciA9PSAnR3JlYXNlbW9ua2V5Jylcblx0XHR7XG5cdFx0XHRfaXNUYW1wZXJtb25rZXkgPSBmYWxzZTtcblx0XHR9XG5cdH1cblx0ZWxzZSBpZiAoX2hhc0dNKVxuXHR7XG5cdFx0X2lzVGFtcGVybW9ua2V5ID0gZmFsc2U7XG5cdH1cblxuXHRsZXQgX3RfbGlzdCA9IFtdO1xuXG5cdGxldCBfdF9rZXlzID0gT2JqZWN0LmtleXMoX0dNQXBpKTtcblxuXHRfR01BcGkuR00gPSBfaGFzR00gPyBHTSA6IHt9IGFzIElHTTtcblxuXHRfdF9rZXlzXG5cdFx0LmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBpbmRleCwgYXJyYXkpXG5cdFx0e1xuXHRcdFx0aWYgKHR5cGVvZiBfR01BcGkuR01bdmFsdWVdID09ICd1bmRlZmluZWQnKVxuXHRcdFx0e1xuXHRcdFx0XHRfR01BcGkuR01bdmFsdWVdID0gX0dNQXBpW3ZhbHVlXTtcblx0XHRcdH1cblxuXHRcdFx0X0dNQXBpWydHTV8nICsgdmFsdWVdID0gX0dNQXBpW3ZhbHVlXTtcblxuXHRcdFx0X3RfbGlzdC5wdXNoKHZhbHVlKTtcblx0XHRcdF90X2xpc3QucHVzaCgnR01fJyArIHZhbHVlKTtcblx0XHR9KVxuXHQ7XG5cblx0ZXhwb3J0IGNvbnN0IF9saXN0OiBzdHJpbmdbXSA9IF90X2xpc3Q7XG5cdGV4cG9ydCBjb25zdCBpc1RhbXBlcm1vbmtleSA9IF9pc1RhbXBlcm1vbmtleTtcblx0ZXhwb3J0IGNvbnN0IGhhc0dNID0gX2hhc0dNO1xuXG5cdF9HTUFwaS51bnNhZmVXaW5kb3cgPSB0eXBlb2YgdW5zYWZlV2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHVuc2FmZVdpbmRvdyA6ICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJ1xuXHRcdD8gd2luZG93XG5cdFx0OiB2b2lkKDApKVxuXHQ7XG5cblx0ZXhwb3J0IGZ1bmN0aW9uIGNhbGwobWV0aG9kOiBzdHJpbmcsIC4uLmFyZ3YpXG5cdHtcblx0XHRpZiAodHlwZW9mIF9HTUFwaVttZXRob2RdID09ICdmdW5jdGlvbicpXG5cdFx0e1xuXHRcdFx0cmV0dXJuIF9HTUFwaVttZXRob2RdLmNhbGwoX0dNQXBpWydHTSddIHx8IG51bGwsIC4uLmFyZ3YpO1xuXHRcdH1cblx0XHRlbHNlIGlmICh0eXBlb2YgX0dNQXBpW21ldGhvZF0gPT0gJ3VuZGVmaW5lZCcpXG5cdFx0e1xuXHRcdFx0Y29uc29sZS53YXJuKGBHTUFwaS4ke21ldGhvZH0gaXMgdW5kZWZpbmVkYCk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIF9HTUFwaVttZXRob2RdO1xuXHR9XG5cblx0ZXhwb3J0IGZ1bmN0aW9uIGNhbGxTYWZlKG1ldGhvZDogc3RyaW5nKVxuXHR7XG5cdFx0aWYgKHR5cGVvZiBfR01BcGlbbWV0aG9kXSA9PSAnZnVuY3Rpb24nKVxuXHRcdHtcblx0XHRcdHJldHVybiBfR01BcGlbbWV0aG9kXTtcblx0XHR9XG5cblx0XHRyZXR1cm4gbmV3IEZ1bmN0aW9uKCk7XG5cdH1cbn1cblxuX0dNQXBpLl9saXN0LmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBpbmRleCwgYXJyYXkpXG57XG5cdGlmICh2YWx1ZS5pbmRleE9mKCdHTV8nKSA9PSAwKVxuXHR7XG5cdFx0bW9kdWxlLmV4cG9ydHNbdmFsdWVdID0gX0dNQXBpW3ZhbHVlXTtcblx0fVxufSk7XG5cbihfR01BcGkgYXMgSUFwaSkuZGVmYXVsdCA9IChfR01BcGkgYXMgSUFwaSkuR01BcGkgPSBfR01BcGkgYXMgSUFwaTtcblxuZXhwb3J0IGNvbnN0IEdNQXBpOiBJQXBpID0gX0dNQXBpIGFzIElBcGk7XG5cbmV4cG9ydCBkZWZhdWx0IChHTUFwaSBhcyBJQXBpKTtcbiJdfQ==